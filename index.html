
<!DOCTYPE html>
<html>
<head>
  <title>1st Grade Math Quiz</title>
  <style>
    body { font-family: sans-serif; padding: 2em; }
    #question { font-size: 24px; margin-bottom: 1em; }
    .explanation {
      margin-top: 10px;
      padding: 10px;
      background: #eef;
      border: 1px dashed #888;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <h1>Math Quiz</h1>
  <div id="question"></div>
  <input id="answer" type="text" />
  <button onclick="submitAnswer()">Submit</button>
  <div id="feedback"></div>

  <script>
    const questions = [
      { question: "What is 5 + 3?", answer: 8 }
    ];
    let current = 0;

    async function fetchExplanation(question, correctAnswer, studentAnswer) {
      try {
        const res = await fetch("/.netlify/functions/explain-answer", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ question, correctAnswer, studentAnswer })
        });

        const data = await res.json();
        return data.explanation || "Let’s try to understand it together!";
      } catch (err) {
        console.error("Explanation error:", err);
        return "Sorry, I couldn’t explain that right now.";
      }
    }

    async function submitAnswer() {
      const userAnswer = document.getElementById("answer").value;
      const correct = questions[current].answer;
      const feedback = document.getElementById("feedback");
      feedback.innerHTML = "";

      if (parseInt(userAnswer) === correct) {
        feedback.textContent = "✅ Correct!";
      } else {
        feedback.textContent = "❌ Incorrect. Try again.";
        const explanationText = await fetchExplanation(questions[current].question, correct, userAnswer);
        const el = document.createElement("div");
        el.className = "explanation";
        el.innerText = explanationText;
        feedback.appendChild(el);
      }
    }

    document.getElementById("question").textContent = questions[current].question;
  </script>
</body>
</html>
